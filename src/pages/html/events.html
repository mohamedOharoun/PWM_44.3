<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
  <script src="../../js/xlu-include-file.js" defer></script>
    <link rel="stylesheet" href="../../templates/css/header.css">
    <link rel="stylesheet" href="../../templates/css/footer.css">
    <link rel="stylesheet" href="../../templates/css/eventssidebar.css">
    <link rel="stylesheet" href="../../templates/css/reduced_card.css">
    <link rel="stylesheet" href="../css/events.css">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <div class="page-content">
    <header id="page_header" xlu-include-file="../../templates/html/header.html"></header>
    <div id="page-area">
        <aside id="sidebar-menu" xlu-include-file="../../templates/html/eventssidebar.html">
        </aside>
        <main>
          <div id="events-header">
            <h1>Lorem Ipsum</h1>
            <a href="create_event_page.html" id="create-event-link">Lorem Ipsum</a>
          </div>
          <hr id="events-hr">
          <section id="events">
          </section>
        </main>
    </div>
    <footer id="main_footer" xlu-include-file="../../templates/html/footer.html"></footer>
  </div>

  <script>
      const stringToHTML = (string) => {
            return new DOMParser().parseFromString(string, "text/html");
      };

      const makeEventCard = async (event_structure, event) => {
          const event_struct = stringToHTML(event_structure);
          event_struct.getElementsByClassName("main-title")[0].textContent = event.name;
          event_struct.getElementsByClassName("subtitle")[0].textContent = event.author;
          event_struct.getElementsByClassName("section-title")[0].textContent = "Description";
          event_struct.getElementsByClassName("description-text")[0].textContent = event.description;
          event_struct.getElementsByClassName("event-time")[0].textContent = event.time;
          event_struct.getElementsByClassName("event-place")[0].textContent = event.place;
          event_struct.getElementsByClassName("event-price")[0].textContent = event.price == 0 ? "FREE" : "$" + event.price;
          event_struct.getElementsByClassName("likes-count")[0].textContent = event.likes;
          event_struct.getElementsByClassName("comments-count")[0].textContent = event.comments;
          event_struct.getElementsByClassName("see-more-button")[0].textContent = "SEE MORE";
          event_struct.getElementsByClassName("participants-count")[0].textContent = event.participants;
          event_struct.getElementsByClassName("participants-label")[0].textContent = "participants";
          event_struct.getElementsByClassName("action-button")[0].textContent = "JOIN";

          const article = document.createElement("article");
          article.innerHTML = event_struct.body.innerHTML;
          article.className = "card";
          return article;
      };

      const loadEventStructure = async () => {
          return await fetch("../../templates/html/reduced_card.html")
              .then(res => res.text());
      };

      const loadJSON = async (file) => {
          return await fetch(`../../locales/${file}`)
              .then(res => res.json());
      };

      const init = async () => {
          const event_structure = await loadEventStructure();
          const events = await loadJSON("events.json");
          const eventsList = document.getElementById("events");
          for (const event of events) {
              const eventCard = await makeEventCard(event_structure, event);
              eventsList.appendChild(eventCard);
          }
      };

      init();
  </script>
</body>
</html>